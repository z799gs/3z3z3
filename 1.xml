<?xml version="1.0" encoding="UTF-8" ?>
<Module>
<ModulePrefs title="-" />
<Content type="html"><![CDATA[

<!DOCTYPE html>
<html lang="en-us">
<head>
    <meta charset="utf-8"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"/>

    <style>
        html, body { padding: 0; margin: 0; overflow: hidden; height: 100%; background: #000; }
        canvas { width: 100%; height: 100%; display: block; }
        canvas:focus { outline: none; }
        #loading-cover {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; display: flex; justify-content: center; align-items: center;
            flex-direction: column; z-index: 999;
        }
        .spinner {
            border: 4px solid rgba(255, 255, 255, 0.1); width: 40px; height: 40px;
            border-radius: 50%; border-left-color: #ffcc00;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        #status-text { color: #888; margin-top: 15px; font-family: sans-serif; font-size: 14px; }
    </style>
</head>
<body>
    <div id="unity-container"><canvas id="unity-canvas"></canvas></div>
    
    <div id="loading-cover">
        <div class="spinner"></div>
        <div id="status-text">Initializing Game Engine...</div>
    </div>

    <script>
        var myGameInstance = null;

        // --- THE MOCK YANDEX OBJECT (Prevents "Data cannot be saved" error) ---
        window.YaGames = {
            init: function() {
                return Promise.resolve(window.ysdk);
            }
        };

        window.ysdk = {
            environment: { i18n: { lang: "en", tld: "com" }, app: { id: "local" }, browser: { lang: "en" }, payload: "" },
            deviceInfo: { 
                type: "desktop", isMobile: () => false, isDesktop: () => true, isTablet: () => false, isTV: () => false 
            },
            adv: {
                showFullscreenAdv: (c) => { c.callbacks.onOpen(); setTimeout(() => c.callbacks.onClose(true), 200); },
                showRewardedVideo: (c) => { c.callbacks.onOpen(); setTimeout(() => { c.callbacks.onRewarded(); c.callbacks.onClose(); }, 200); },
                getBannerAdvStatus: () => Promise.resolve({ stickyAdvIsShowing: false }),
                hideBannerAdv: () => {}, showBannerAdv: () => {}
            },
            shortcut: { canShowPrompt: () => Promise.resolve({canShow: false}), showPrompt: () => Promise.resolve({outcome: 'rejected'}) },
            feedback: { canReview: () => Promise.resolve({value: false}), requestReview: () => Promise.resolve({feedbackSent: false}) },
            getPlayer: () => Promise.resolve({
                getName: () => "Guest", getPhoto: () => "null", getUniqueID: () => "0", getMode: () => "lite",
                setData: () => Promise.resolve(), getData: () => Promise.resolve({saves: "noData"})
            }),
            getPayments: () => Promise.resolve({ getCatalog: () => Promise.resolve([]), getPurchases: () => Promise.resolve([]) }),
            getLeaderboards: () => Promise.resolve({ 
                getLeaderboardDescription: () => Promise.resolve({}), 
                getLeaderboardEntries: () => Promise.resolve({entries: []}) 
            })
        };

        // --- GLOBAL SDK FUNCTIONS ---
        function StaticRBTDeactivate() {}
        function PaintRBT(rbt) {}
        function InitSDK() { 
            // Signal Unity that the SDK is ready as soon as it asks
            if(myGameInstance) {
                InitPlayer();
                RequestingEnvironmentData();
            }
        }
        function InitGame() { InitSDK(); }
        function LanguageRequest() { if(myGameInstance) myGameInstance.SendMessage('YandexGame', 'SetLanguage', 'en'); }

        function RequestingEnvironmentData() {
            var data = JSON.stringify({
                "language": "en", "domain": "com", "deviceType": "desktop", "isMobile": false,
                "isDesktop": true, "appID": "local", "browserLang": "en", "promptCanShow": false, "reviewCanShow": false
            });
            if(myGameInstance) myGameInstance.SendMessage('YandexGame', 'SetEnvironmentData', data);
        }

        function InitPlayer() {
            var player = JSON.stringify({ "playerAuth": "resolved", "playerName": "Guest", "playerId": "0", "playerPhoto": "null" });
            if(myGameInstance) myGameInstance.SendMessage('YandexGame', 'SetInitializationSDK', player);
        }

        function GetPayments() {
            if(myGameInstance) myGameInstance.SendMessage('YandexGame', 'PaymentsEntries', JSON.stringify({id:[], title:[], description:[], imageURI:[], priceValue:[]}));
        }

        function FullAdShow() {
            if(myGameInstance) {
                myGameInstance.SendMessage('YandexGame', 'OpenFullAd');
                setTimeout(() => myGameInstance.SendMessage('YandexGame', 'CloseFullAd', 'true'), 300);
            }
        }

        function RewardedShow(id) {
            if(myGameInstance) {
                myGameInstance.SendMessage('YandexGame', 'OpenVideo');
                setTimeout(() => { myGameInstance.SendMessage('YandexGame', 'RewardVideo', id); myGameInstance.SendMessage('YandexGame', 'CloseVideo'); }, 300);
            }
        }

        function LoadCloud() { if(myGameInstance) myGameInstance.SendMessage('YandexGame', 'SetLoadSaves', "noData"); }
        function SaveCloud() {}
        function InitLeaderboard() { if(myGameInstance) myGameInstance.SendMessage('YandexGame', 'InitializedLB'); }
        function GetLeaderboardScores() { if(myGameInstance) myGameInstance.SendMessage('YandexGame', 'LeaderboardEntries', JSON.stringify({entries: 'no data'})); }
        function SetLeaderboardScores() {}
        function Review() {}
        function PromptShow() {}
        function StickyAdActivity() {}
        function BuyPayments() {}
        function ConsumePurchase(id) { if(myGameInstance) myGameInstance.SendMessage('YandexGame', 'OnPurchaseSuccess', id); }

        // --- UNITY LOADER ---
        const buildUrl = "https://cdn.jsdelivr.net/gh/z799gs/3z3z3@main/Build";
        const loaderUrl = buildUrl + "/SteepDescent.loader.js";
        const config = {
            dataUrl: buildUrl + "/08ed5de1ab67a9c2ae11d2f97f2780e8.data.unityweb",
            frameworkUrl: buildUrl + "/56cfcbc5a9b96769504612ff8878b999.js.unityweb",
            codeUrl: buildUrl + "/5f14ad0fdcb130010a9ca539b8acc937.wasm.unityweb",
            streamingAssetsUrl: "StreamingAssets",
            companyName: "JustPlay",
            productName: "CarCrashTest",
            productVersion: "1",
        };

        const script = document.createElement("script");
        script.src = loaderUrl;
        script.onload = () => {
            createUnityInstance(document.querySelector("#unity-canvas"), config, (progress) => {
                document.querySelector("#status-text").innerText = "Loading: " + Math.round(progress * 100) + "%";
            }).then((instance) => {
                myGameInstance = instance;
                document.querySelector("#loading-cover").style.display = "none";
                
                // Force sync environment right after load to prevent black screen
                setTimeout(() => {
                    InitSDK();
                    LanguageRequest();
                }, 500);

            }).catch((err) => { console.error(err); });
        };
        document.body.appendChild(script);
    </script>

    <style>
  #ad-container {
    position: fixed;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: min(728px, calc(100% - 20px));
    height: 90px;
    background: rgba(0, 0, 0, 0.90);
    display: none;
    z-index: 99999;
    overflow: hidden;
    box-shadow: 0 -2px 12px rgba(0, 0, 0, 0.45);
    transition: transform 0.5s ease-in-out;
  }

  #ad-container.hidden { transform: translate(-50%, 100%); }

  #ad-iframe {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 745px;
    height: 90px;
    border: 0;
  }

  /* Close button: Initial Top Center */
  #close-ad {
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%) scale(0.9);
    transform-origin: center;
    background: #ff4d4d;
    color: #fff;
    border: none;
    padding: 5px 10px;
    font-size: 11px;
    font-weight: bold;
    border-radius: 4px;
    cursor: not-allowed;
    opacity: 0.9;
    z-index: 100000;
    white-space: nowrap;
    transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }

  /* Corner State Styling */
  #close-ad.enabled {
    cursor: pointer;
    opacity: 1;
    background: #ff1a1a;
    box-shadow: 0 0 15px #ff4d4d, 0 0 30px #ff4d4d;
    animation: glow-pulse 1.5s infinite alternate;
  }

  @keyframes glow-pulse {
    from { box-shadow: 0 0 5px #ff4d4d, 0 0 10px #ff4d4d; }
    to { box-shadow: 0 0 20px #ff4d4d, 0 0 35px #ff4d4d; opacity: 0.8; }
  }

  #close-ad::before {
    content: 'âœ•';
    margin-right: 2px;
  }

  @media (max-width: 440px) {
    #ad-container { width: calc(100% - 12px); }
    #ad-iframe { width: 728px; }
  }
</style>

<div id="ad-container" aria-hidden="true">
  <iframe id="ad-iframe" src="https://script.google.com/macros/s/AKfycbzNG4z_PlG6Ke_bX5wSPKK2uBRB3IY9ouVzqM1shucYhSTvsJWRmyMyZaaC2z5S3ADN/exec" scrolling="no" frameborder="0" sandbox="allow-scripts allow-popups allow-same-origin"></iframe>
  <button id="close-ad" disabled>Wait (12)</button>
</div>

<script>
  (function () {
    const showDelay = 2000; 
    const countdownStart = 12; 
    const reappearDelay = 150000; // 2.5 MINUTES (150 seconds)
    const adContainer = document.getElementById('ad-container');
    const closeBtn = document.getElementById('close-ad');

    function setRandomCorner() {
      const corners = [
        { top: '2px', left: '2px', right: 'auto', bottom: 'auto', transform: 'scale(0.5)' },    // Top-Left
        { top: '2px', left: 'auto', right: '2px', bottom: 'auto', transform: 'scale(0.5)' },   // Top-Right
        { top: 'auto', left: '2px', right: 'auto', bottom: '2px', transform: 'scale(0.5)' },   // Bottom-Left
        { top: 'auto', left: 'auto', right: '2px', bottom: '2px', transform: 'scale(0.5)' }    // Bottom-Right
      ];
      
      const randomChoice = corners[Math.floor(Math.random() * corners.length)];
      Object.assign(closeBtn.style, randomChoice);
    }

    function resetToCenter() {
      closeBtn.style.top = '0';
      closeBtn.style.left = '50%';
      closeBtn.style.right = 'auto';
      closeBtn.style.bottom = 'auto';
      closeBtn.style.transform = 'translateX(-50%) scale(0.9)';
    }

    function showAd() {
      resetToCenter();
      adContainer.style.display = 'block';
      adContainer.classList.remove('hidden');
      
      let timeLeft = countdownStart;
      closeBtn.disabled = true;
      closeBtn.classList.remove('enabled');
      closeBtn.textContent = `Wait (${timeLeft})`;

      const t = setInterval(() => {
        timeLeft--;
        if (timeLeft > 0) {
          closeBtn.textContent = `Wait (${timeLeft})`;
        } else {
          clearInterval(t);
          closeBtn.disabled = false;
          closeBtn.textContent = ''; 
          setRandomCorner(); 
          closeBtn.classList.add('enabled'); 
        }
      }, 1000);
    }

    setTimeout(showAd, showDelay);

    closeBtn.addEventListener('click', () => {
      if (closeBtn.disabled) return;
      adContainer.classList.add('hidden');
      // Set to reappear after 150 seconds
      setTimeout(showAd, reappearDelay);
    });
  })();
</script>

</body>
</html>

]]></Content>
</Module>